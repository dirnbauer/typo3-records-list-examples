<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      xmlns:core="http://typo3.org/ns/TYPO3/CMS/Core/ViewHelpers"
      xmlns:be="http://typo3.org/ns/TYPO3/CMS/Backend/ViewHelpers"
      data-namespace-typo3-fluid="true">

<f:comment>
    Catalog View - Large image cards with overlay title.
    Part of EXT:records_list_examples.
</f:comment>

<div class="rle-catalog-container">

    <f:if condition="{tableData}">
        <f:then>
            <f:for each="{tableData}" as="table">
                <div class="recordlist" id="t3-table-{table.tableName}"
                     data-multi-record-selection-identifier="t3-table-{table.tableName}">
                    <f:comment>Table heading (from base.css)</f:comment>
                    <div class="recordlist-heading multi-record-selection-panel">
                        <div class="recordlist-heading-row">
                            <div class="recordlist-heading-title">
                                <f:if condition="{currentTable}">
                                    <f:then>
                                        <a href="{table.clearTableUrl}">
                                            <span class="fw-bold">{table.tableLabel}</span>
                                            <span>({table.recordCount})</span>
                                            <span class="ms-1"><core:icon identifier="actions-view-table-collapse" size="small" /></span>
                                        </a>
                                    </f:then>
                                    <f:else>
                                        <a href="{table.singleTableUrl}">
                                            <span class="fw-bold">{table.tableLabel}</span>
                                            <span>({table.recordCount})</span>
                                            <span class="ms-1"><core:icon identifier="actions-view-table-expand" size="small" /></span>
                                        </a>
                                    </f:else>
                                </f:if>
                            </div>
                            <div class="recordlist-heading-actions">
                                <f:if condition="{table.actionButtons.newRecordButton}">
                                    <f:format.raw>{table.actionButtons.newRecordButton}</f:format.raw>
                                </f:if>
                                <f:if condition="{table.actionButtons.downloadButton}">
                                    <f:format.raw>{table.actionButtons.downloadButton}</f:format.raw>
                                </f:if>
                                <f:if condition="{table.actionButtons.collapseButton}">
                                    <f:format.raw>{table.actionButtons.collapseButton}</f:format.raw>
                                </f:if>
                            </div>
                        </div>

                        <f:comment>Multi Record Selection action bar</f:comment>
                        <f:if condition="{table.multiRecordSelectionActionsHtml}">
                            <div class="recordlist-heading-row t3js-multi-record-selection-actions hidden">
                                <div class="recordlist-heading-title">
                                    <strong><f:translate key="LLL:EXT:core/Resources/Private/Language/locallang_core.xlf:labels.selection" default="Selection" /></strong>
                                </div>
                                <div class="recordlist-heading-actions">
                                    <f:format.raw>{table.multiRecordSelectionActionsHtml}</f:format.raw>
                                </div>
                            </div>
                        </f:if>
                    </div>

                    <div class="collapse show" data-state="expanded" id="recordlist-{table.tableName}">
                        <f:if condition="{currentTable}">
                            <f:render partial="Pagination" arguments="{paginator: table.paginator, pagination: table.pagination, paginationUrl: table.paginationUrl, tableName: table.tableName, position: 'top'}" />
                        </f:if>

                        <div class="rle-catalog-grid" data-multi-record-selection-row-selection="true">
                            <f:for each="{table.records}" as="record">
                                <div class="rle-catalog-card{f:if(condition: record.hidden, then: ' rle-catalog-card--hidden')}"
                                     data-multi-record-selection-element="true"
                                     data-uid="{record.uid}">
                                    <f:comment>Image area</f:comment>
                                    <div class="rle-catalog-card__image">
                                        <f:if condition="{record.thumbnailUrl}">
                                            <f:then>
                                                <be:link.editRecord uid="{record.uid}" table="{record.tableName}">
                                                    <img src="{record.thumbnailUrl}" class="rle-catalog-card__img" alt="{record.title}" loading="lazy" />
                                                </be:link.editRecord>
                                            </f:then>
                                            <f:else>
                                                <div class="rle-catalog-card__placeholder">
                                                    <core:icon identifier="actions-image" size="default" />
                                                    <span class="rle-catalog-card__placeholder-text">No image</span>
                                                </div>
                                            </f:else>
                                        </f:if>

                                        <f:comment>Preview hint - shown when image exists</f:comment>
                                        <f:if condition="{record.thumbnailUrl}">
                                            <div class="rle-catalog-card__image-hint">
                                                <core:icon identifier="actions-info" size="small" />
                                                <f:translate key="LLL:EXT:records_list_types/Resources/Private/Language/locallang.xlf:image.previewOnly" default="Preview only — may not appear on the frontend for this record type." />
                                            </div>
                                        </f:if>

                                        <f:comment>Hidden badge overlay</f:comment>
                                        <f:if condition="{record.hidden}">
                                            <span class="rle-catalog-card__badge rle-catalog-card__badge--hidden">
                                                <core:icon identifier="actions-edit-hide" size="small" /> Hidden
                                            </span>
                                        </f:if>
                                    </div>

                                    <f:comment>Info area</f:comment>
                                    <div class="rle-catalog-card__body">
                                        <div class="rle-catalog-card__title-row">
                                            <label class="rle-catalog-card__checkbox">
                                                <input class="form-check-input t3js-multi-record-selection-check"
                                                       type="checkbox" />
                                            </label>
                                            <be:link.editRecord uid="{record.uid}" table="{record.tableName}" class="rle-catalog-card__title">
                                                {record.title}
                                            </be:link.editRecord>
                                            <span class="rle-catalog-card__uid">#{record.uid}</span>
                                        </div>

                                        <f:for each="{record.displayValues}" as="field">
                                            <f:if condition="{field.type} == 'text' && !{field.isLabelField} && !{field.isEmpty}">
                                                <p class="rle-catalog-card__teaser">{field.formatted -> f:format.crop(maxCharacters: 120, append: '…')}</p>
                                            </f:if>
                                        </f:for>

                                        <div class="rle-catalog-card__actions">
                                            <be:link.editRecord uid="{record.uid}" table="{record.tableName}"
                                                class="rle-catalog-card__action" title="Edit">
                                                <core:icon identifier="actions-open" size="small" />
                                            </be:link.editRecord>
                                            <f:if condition="{record.hidden}">
                                                <f:then>
                                                    <button type="button" class="rle-catalog-card__action"
                                                            data-gridview-action="show"
                                                            data-table="{record.tableName}" data-uid="{record.uid}" title="Show">
                                                        <core:icon identifier="actions-edit-unhide" size="small" />
                                                    </button>
                                                </f:then>
                                                <f:else>
                                                    <button type="button" class="rle-catalog-card__action"
                                                            data-gridview-action="hide"
                                                            data-table="{record.tableName}" data-uid="{record.uid}" title="Hide">
                                                        <core:icon identifier="actions-edit-hide" size="small" />
                                                    </button>
                                                </f:else>
                                            </f:if>
                                            <button type="button" class="rle-catalog-card__action rle-catalog-card__action--danger"
                                                    data-gridview-action="delete"
                                                    data-table="{record.tableName}" data-uid="{record.uid}" title="Delete">
                                                <core:icon identifier="actions-edit-delete" size="small" />
                                            </button>

                                            <f:comment>More Actions dropdown</f:comment>
                                            <div class="dropdown">
                                                <button type="button" class="rle-catalog-card__action"
                                                        data-bs-toggle="dropdown"
                                                        aria-expanded="false"
                                                        title="More actions">
                                                    <core:icon identifier="actions-menu-alternative" size="small" />
                                                </button>
                                                <ul class="dropdown-menu dropdown-menu-end">
                                                    <li>
                                                        <a class="dropdown-item" href="#"
                                                           data-gridview-action="info"
                                                           data-table="{record.tableName}"
                                                           data-uid="{record.uid}">
                                                            <core:icon identifier="actions-document-info" size="small" />
                                                            <span>Info</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="dropdown-item" href="#"
                                                           data-gridview-action="history"
                                                           data-table="{record.tableName}"
                                                           data-uid="{record.uid}">
                                                            <core:icon identifier="actions-document-history-open" size="small" />
                                                            <span>History</span>
                                                        </a>
                                                    </li>
                                                    <li><hr class="dropdown-divider"></li>
                                                    <li>
                                                        <a class="dropdown-item" href="#"
                                                           data-gridview-action="copy"
                                                           data-table="{record.tableName}"
                                                           data-uid="{record.uid}">
                                                            <core:icon identifier="actions-edit-copy" size="small" />
                                                            <span>Copy</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="dropdown-item" href="#"
                                                           data-gridview-action="cut"
                                                           data-table="{record.tableName}"
                                                           data-uid="{record.uid}">
                                                            <core:icon identifier="actions-edit-cut" size="small" />
                                                            <span>Cut</span>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </f:for>
                        </div>

                        <f:if condition="!{currentTable} && {table.hasMore}">
                            <div class="text-center py-2 border-top">
                                <a href="{table.singleTableUrl}" class="btn btn-sm btn-default">
                                    <core:icon identifier="actions-caret-down" size="small" />
                                    <f:translate key="LLL:EXT:core/Resources/Private/Language/locallang_core.xlf:labels.expandTable" default="Expand table" />
                                </a>
                            </div>
                        </f:if>

                        <f:if condition="{currentTable}">
                            <f:render partial="Pagination" arguments="{paginator: table.paginator, pagination: table.pagination, paginationUrl: table.paginationUrl, tableName: table.tableName, position: 'bottom'}" />
                        </f:if>
                    </div>
                </div>
            </f:for>
        </f:then>
        <f:else>
            <div class="callout callout-info">
                <div class="callout-body">
                    <core:icon identifier="actions-info" size="small" />
                    <span class="ms-2">No records found on this page.</span>
                </div>
            </div>
        </f:else>
    </f:if>

</div>

</html>
